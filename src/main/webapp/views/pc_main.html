<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:tiles="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="description" content="Pathogenicity Calculator">
    <meta name="author" content="Milinkov Miroslav Persida DOO">
    <meta name="keywords" content="Pathogenicity Calculator,ClinGen,Persida DOO">

    <meta property="og:title" content="Pathogenicity Calculator">
    <meta property="og:url" content="http://www.pathogenicity-calculator.com">
    <meta property="og:site_name" content="Pathogenicity Calculator">
    <meta property="og:type" content="website">
    <meta name="twitter:title" content="Pathogenicity Calculator">

    <title>Pathogenicity Calculator</title>

    <!-- Bootstrap 4 - CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">

    <!-- Google fonts -->
    <link href='https://fonts.googleapis.com/css?family=Roboto|Roboto:200,300,400,500,600,700"' rel='stylesheet'>

    <!-- jQuery  -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

    <!-- Bootstrap 4 - JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="8glijwyao9fq8we"></script>

    <!-- native CSS -->
    <link rel="stylesheet" type="text/css" href="../style/pc_main.css"/>

    <!-- native JS -->
    <script src="../js/intro_page/pc_main.js"></script>
    <script src="../js/common.js"></script>
    <script src="../js/intro_page/recentVariantInterpretationHandler.js"></script>
    
</head>
<body onload="loadDefault()">
<div id="mainContainer">
    <div id="headerContainer">
        <div id="logoHeadeContainer"></div>
        <p>PATHOGENICITY CALCULATOR</p>
        <div id="usrnameAndSignoutBtn">
            <p th:text="${currentUserName}"></p>
            <div class="calcMainMenuBtns"><a href="/logout" id="signOutLink"><p>Logout</p><img src="../images/logout-button.png"></a></div>
        </div>
    </div>

    <div id="warrningMessageDiv">
        <p id="warrningMessageP"></p>
        <button onclick="closeWarringDiv()">x</button>
    </div>

    <div id="mainMenuDiv">
        <div class="mainMenuButtons" onclick="openNewInterpretationPopUp()">Start new interpretation</div>
        <div class="mainMenuButtons" onclick="openUserVariantCollectionPopUp()">Search variant in your collection</div>
        <div class="mainMenuButtons">Download data</div>
    </div>
    
    <div id="contentContainer">
        
        <div class="basicResultsDiv" id="variantsSummary">
            <div class="basicResultsDivLabel">Summary of interpreted variants</div>
            <table id="variantSummaryTable">
                <tr>
                    <th></th>
                    <th>Benign</th>
                    <th>Benign-BA1</th>
                    <th>Likely-Benign</th>
                    <th>Likely-Pathogenic</th>
                    <th>Pathogenic</th>
                    <th>VUS-Conflicting</th>
                    <th>VUS-Insufficient</th>
                    <th>Undetermined</th>
                    <th>Non ACMG</th>
                </tr>
                <tr style="border-top: 1px solid rgb(204, 200, 204);">
                    <td style="font-weight: bold;">MARS2</td>
                    <td>0</td>
                    <td><div class="summaryBtnDiv" onclick="">1</div></td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                </tr>
                <tr style="border-top: 1px solid rgb(204, 200, 204);">
                    <td style="font-weight: bold;">NDUFS8</td>
                    <td>0</td>
                    <td>0</td>
                    <td><div class="summaryBtnDiv" onclick="">1</div></td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td><div class="summaryBtnDiv" onclick="">1</div></td>
                    <td>0</td>
                    <td>0</td>
                </tr>
            </table>
        </div>
        <div class="basicResultsDiv" id="recentActivity">
            <div class="basicResultsDivLabel">Recent Activity</div>
            <p>Recently Interpreted Variants</p>
            <div id="recentVariantsContainer"></div>
        </div>
    </div>

    <div class="basicResultsDiv" id="variantsListing">
        <div class="basicResultsDivLabel">Variants Listing</div>
        <table id="variantListingTable">
        </table>
        <div id="startNewInterpDivBtn" disabled onclick="startNewInterpretation(this)">Start New Interpretation</div>

        <!--
        <div style="width: 100%; height: max-content; text-align: right; margin-top: 15px; padding:8px 10px 8px 0px; font-size: 12px;">
            <b>Showing 1 of 1 variants</b>
        </div>
        -->
    </div>

    <hr id="bottomLine">
    <div style="width: 92%; height:auto; margin-top: 0.7vh;">
        <p id="pwdByMsg" style="color:rgba(50, 110, 150); margin:0px; float:right; font-size: 12px;"></p>
    </div>
    
    <div id="input-new-interpretation-modal" class="modal fade" tabindex="-1" role="dialog" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header" style="border-radius: none; background-color: rgba(50, 110, 150); color:white;">
                    <div id="interpretationPopUpTitle" class="modal-title">Pathogenicity Calculator</div>
                    <button id="closePopUp" type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true" style="color:white;">×</span>
                    </button>
                </div>
    
                <div class="modal-body">
                    <input type="text" id="newVarinatInp" placeholder="Search registry by CAID or HGVS expression..." size="60">
                    <button id="searchNewVarBtn" type="button" onclick="searchNewVariant()">Search</button> 
                    <p style="margin: 15px 0px 0px 0px;"><b>CAID example:</b> CA321211</p>   
                    <p style="margin: 0px;"><b>HGVS example:</b> NM_002496.3:c.64C>T, NM_138395.3:c.1615C>T</p>   
                </div>
            </div>
        </div>
    </div>
    <button type="button" id="openInputNewInterpretationModal" style="display:none;" data-toggle="modal" data-target="#input-new-interpretation-modal">blank</button>

    <div id="varinat-collection-modal" class="modal fade" tabindex="-1" role="dialog" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header" style="border-radius: none; background-color: rgba(50, 110, 150); color:white;">
                    <div id="varintCollectionpopUpTitle" class="modal-title">Pathogenicity Calculator</div>
                    <button id="closePopUp" onclick="resetInterpretedVariantsContainner()" type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true" style="color:white;">×</span>
                    </button>
                </div>
    
                <div class="modal-body">
                    <input type="text" id="partialVarCaIDInp" onkeyup="searchInterpretedCAIDs(this.value)" placeholder="Start typing CAID to generate an autocomplete list..." size="60">
                    <p style="margin: 15px 0px 0px 0px;"><b>CAID example:</b> CA321211</p>

                    <div id="interpretedVariantContainner">
                    <div>  
                </div>
            </div>
        </div>
    </div>
    <button type="button" id="openVarinatCollectionModal" style="display:none;" data-toggle="modal" data-target="#varinat-collection-modal">blank</button>
</div>

    <script>
        console.log("At pc_main page!");
        $(".modal").draggable( {handle: ".modal-header"} );

        function loadDefault(){
            var currentYear = (new Date()).getFullYear();
            document.getElementById("pwdByMsg").innerHTML = "©"+currentYear+" ClinGen";

            loadRecentVariants();
        }

        function openWarringDiv(message){
            let elem = document.getElementById("warrningMessageDiv");
            elem.style.display = "flex";     
            document.getElementById("warrningMessageP").innerHTML = message;     
        }

        function closeWarringDiv(){
            let elem = document.getElementById("warrningMessageDiv");
            document.getElementById("warrningMessageP").innerHTML = '';
            elem.style.display = "none";        
        }

        function openNewInterpretationPopUp(){
            document.getElementById("openInputNewInterpretationModal").click();
            document.getElementById("interpretationPopUpTitle").innerText = "Start New Interpretation";
        }

        function closeNewInterpretationPopUp(){
            document.getElementById('openInputNewInterpretationModal').click(); 
        }

        function openUserVariantCollectionPopUp(){
            document.getElementById("openVarinatCollectionModal").click();
            document.getElementById("varintCollectionpopUpTitle").innerText = "Display variant collection";
        }

        function closeUserVariantCollectionPopUp(){
            document.getElementById("openVarinatCollectionModal").click();
        }

        function resetInterpretedVariantsContainner(){
            clearSelectChooser(document.getElementById("interpretedVariantContainner"));
            document.getElementById("partialVarCaIDInp").value ="";
        }

        function enableNewInterpretationBtn(variantCaIdInp){
            let startNewInterpDivBtn = document.getElementById('startNewInterpDivBtn');
            startNewInterpDivBtn.disabled=false;
            startNewInterpDivBtn.setAttribute('data-value', variantCaIdInp+"_0");
        }

        function startNewInterpretation(divBtnElem){
            goToCalculatorPage(divBtnElem);
        }
    </script>
</body>
</html>